<html> 
<head>   
  <meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {font-family: Arial, Helvetica, sans-serif;}

/* The Modal (background) */
.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
}

/* The Close Button */
.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}
div.a {
  position: relative;
  width: 400px;
  height: 200px;
  border: 3px solid red;
}
.shadow{
  float:center;
  margin-left:20px;
  background: white;
  transition-duration: 0.5s;
  width:250px;
  height:200px;
}
.shadow:hover{
 -webkit-box-shadow: #ccc 0px 10px 10px;
 -moz-box-shadow: #ccc 0px 10px 10px;
 box-shadow: #ccc 0px 10px 10px;  
}
.round_icon{
  width: 100px;
  height: 100px;
  display: flex;
  border-radius: 50%;
  align-items: left;
  justify-content: left;
  overflow: hidden;
}
</style>      
</head>

<body> 
 <!-- Input data page-->   
<div>

    <h1 style="text-align: center"> Please enter you personal water usage habits </h1>           
    <div>  
          
        <p>How many times you use toilet per day?  </p><br>  
        <input type="text" size=65 name="A1" id = "A1" placeholder="Number of toilet use times">     
        <p>How many times you use tap per day?</p><br> 
        <input type="text" size=65 name="A2" id = "A2" placeholder="Number of tap use times">
        <p>How long do you take a shower per times?</p><br>
        <input type="text" size=65 name="A3" id = "A3" placeholder="The minutes of your shower"> 
        <p>How many times you take a shower per week?</p><br>
        <input type="text" size=65 name="A4" id = "A4" placeholder="Number is required"> 
        <p>How long do you water the garden every time?</p><br>
        <input type="text" size=65 name="A5" id = "A5" placeholder="Number is required">
        <p>How many times a week do you clean your pet?</p><br>
        <input type="text" size=65 name="A6" id = "A6" placeholder="Number is required"><br><br>

        <!-- Trigger/Open The Modal -->
        <button id="myBtn" >Try me</button>
        <!-- The Modal -->
        <div id="myModal" class="modal">

        <!-- Modal content -->
        <div class="modal-content">
        <span class="close">&times;</span>
        <h1 style="text-align: center"> Your personal water usage report </h1>
           <div style="text-align: left" >
            <h2 style="text-align: left"> Your personal water usage </h2>
            <p>Your daily toilet water consumption:  </p><br>
            <input type='text' id='a'  disabled/>
            <p>Your daily tap water consumption:  </p><br>
            <input type='text' id='b'  disabled/>
            <p>Your daily shower water consumption:  </p><br>
            <input type='text' id='c'  disabled/>
            <p>Your daily garden water consumption:  </p><br>
            <input type='text' id='d'  disabled/>
            <p>Your daily clean pet water consumption:  </p><br>
            <input type='text' id='e'  disabled/>
            <p>Your total water usage per day:  </p><br>
            <input type='text' id='f'  disabled/>
           </div>
           <p id = "output"></p>

         <!--Size of the donut chart-->
          <div id="chartContainer" style="height: 500px; width: 500px;"></div>
            <div id='myDiv2'><!-- Plotly chart will be drawn inside this DIV --></div>
          <div  class = "shadow" id="myDiv" style= "border-style:initial;border-width:10px;">
          <!--img src="" class="round_icon"  alt=""-->
          <p id="demo" style = "text-align: center;font-size: 20px;color:red"></p>
          <h1 style = "text-align: center; font-size: 25px;">Time left till run out of the fresh water of the world</h1>
          </div> 
    </div>
</div>

        <!-- create a donuts chart base on user input data -->
        <script type="text/javascript" src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
        <script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
        <script type="text/javascript">
        
        function myFunction1() 
        {
            //Define and calculate the percentage of water used for each part
            var a1 = document.getElementById("A1");               
            var a2 = document.getElementById("A2");    
            var a3 = document.getElementById("A3");  
            var a4 = document.getElementById("A4");
            var a5 = document.getElementById("A5");
            var a6 = document.getElementById("A6");
            var toilet = (a1.value)*3.83;
            var tap = (a2.value)*2.2925;
            var shower = (a3.value)*(a4.value)*11.43/7;
            var gardon = (a5.value)* 15/7;
            var pet = (a6.value)* 50/7;
            var outdoor = parseInt(gardon+pet);
            var total = toilet + tap + shower + gardon + pet;
            var n1 = toilet.toFixed(2);           
            var n2= tap.toFixed(2);           
            var n3 = shower.toFixed(2);
            var n4 = gardon.toFixed(2);           
            var n5 = pet.toFixed(2);
            var p1 = parseInt(toilet/total*100);
            var p2 = parseInt(tap/total*100);
            var p3 = parseInt(shower/total*100);
            var p4 = parseInt(gardon/total*100);
            var p5 = parseInt(pet/total*100);
            var chart = new CanvasJS.Chart("chartContainer",
          {
            //title of the graph title
            title:{
              text: "Personal water consumption",
              fontFamily: "Impact",
              fontWeight: "normal"
            },
            //Labels, data for donut chart
            data: [
            {
              //startAngle: 45,
              indexLabelFontSize: 20,
              indexLabelFontFamily: "Garamond",
              indexLabelFontColor: "darkgrey",
              indexLabelLineColor: "darkgrey",
              indexLabelPlacement: "outside",
             type: "doughnut",
             showInLegend: true,
             dataPoints: [
             {  y:n1, legendText:"Toilet usage",indexLabel: "Toilet" + p1 + "%" },
             {  y:n2, legendText:"Tap usage",indexLabel: "Tap" + p2 + "%" },
             {  y:n3, legendText:"Shower usage",indexLabel: "Shower"+ p3 + "%" },
             {  y:n4, legendText:"Gardon usage",indexLabel: "Gardon"+ p4 + "%" },
             {  y:n5, legendText:"Pet usage",indexLabel: "Pet"+ p5 + "%" }
             ]
           }
           ]
         });

         //Display donut chart
          chart.render();

            var bar1 = {
                x: [toilet, tap, shower,outdoor,total],
                y: ['Toilet', 'Tap', 'Shower','Outdoor', 'Total'],
                name: 'Your usage',
                type: 'bar',
                orientation: 'h'
            };
b
            var bar2 = {
                x: [20,18,80,37,155],
                y: ['Toilet', 'Tap', 'Shower','Outdoor', 'Total'],
                name: 'Recommended',
                type: 'bar',
                orientation: 'h'
            };

            var data = [bar2, bar1];

            var layout = { title: 'Compare with our goal', barmode: 'group'};

            Plotly.newPlot('myDiv2', data, layout);

        }
        </script>
        <script>
          // Get the modal
          var modal = document.getElementById("myModal");

          // Get the button that opens the modal
          var btn = document.getElementById("myBtn");

          // Get the <span> element that closes the modal
          var span = document.getElementsByClassName("close")[0];

          // When the user clicks the button, open the modal 
          btn.onclick = function() {
           myFunction();
           modal.style.display = "block";
          }
     
         // When the user clicks on <span> (x), close the modal
         span.onclick = function() {
         modal.style.display = "none";
         }

        // When the user clicks anywhere outside of the modal, close it
         window.onclick = function(event) {
           if (event.target == modal) {
               modal.style.display = "none";
           }
         }
        //Calculation function       
            function myFunction() 
            {            
                myFunction1();
                var a1 = document.getElementById("A1");               
                var a2 = document.getElementById("A2");    
                var a3 = document.getElementById("A3");  
                var a4 = document.getElementById("A4"); 
                var a5 = document.getElementById("A5"); 
                var a6 = document.getElementById("A6");
                var toilet = (a1.value)*3.83;
                var tap = (a2.value)*2.2925;
                var shower = (a3.value)*(a4.value)*11.43/7;
                var gardon = (a5.value)* 15/7;
                var pet = (a6.value)* 50/7;
                var total = (a1.value)*3.83 + (a2.value)*2.2925 + (a3.value)*(a4.value)*11.43/7 + ((a5.value)* 15/7) + ((a6.value)* 50/7);
                var inputOne = total;
                var inputTwo = 155;
                var result;
                a.value = toilet.toFixed(2) + " L";           
                b.value = tap.toFixed(2) + " L";           
                c.value = shower.toFixed(2) + " L";
                d.value = gardon.toFixed(2) + " L";           
                e.value = pet.toFixed(2) + " L";   
                f.value = total.toFixed(2) + " L";

                //Determine whether the user's daily water consumption exceeds 155L
                if (inputOne <= inputTwo)
                {
                    result = "Your total water usage per week is less than target 155L/day! <br>You have a good water habit, which effectively protects Melbourne’s Water catchment, please continue to maintain it. <br>For more detailed water saving tips, you can go to the Tip page.";
                    document.getElementById("output").style.color = 'Green'
                }
                else
                {
                    result = "Your total water usage per week is bigger than target 155L/day! <br>Your water usage habits are bad. Please reduce your daily water consumption for Melbourne's Water catchment. <br>According to your water usage habits, we recommend: <br>1. Use the toilet less than 5 times a day; <br>2. Turn off the faucet when brushing your teeth; <br>3. The best time for shower should be within 5 minutes; <br>4. Appropriately reduce garden water use, and choose resistant Dry planting; <br>5. Do not clean your pet too frequently. <br>For more detailed water saving tips, you can go to the Tip page.";
                    document.getElementById("output").style.color = 'Red'
                  

                }
                document.getElementById("output").innerHTML=result;
               
            }
        // Set the date we're counting down to
        var countDownDate = new Date("Jan 5, 2040 16:47:25").getTime();

        // Update the count down every 1 second
        var x = setInterval(function() {

        // Get today's date and time
        var now = new Date().getTime();
    
        // Find the distance between now and the count down date
        var distance = countDownDate - now;
    
       // Time calculations for days, hours, minutes and seconds
       var years = Math.floor(distance / (1000 * 60 * 60 * 24 * 365));
       var days = Math.floor((distance / (1000 * 60 * 60 * 24)) % 365);
       var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
       var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
       var seconds = Math.floor((distance % (1000 * 60)) / 1000);
    
      // Output the result in an element with id="demo"
      document.getElementById("demo").innerHTML = years + "y " + days + "d " + hours + "h " + minutes + "m " + seconds + "s ";
      // If the count down is over, write some text 
        if (distance < 0) 
        {
           clearInterval(x);
           document.getElementById("demo").innerHTML = "EXPIRED";
        }
      }, 1000);        
                
            
    </script>        
    </div>
    </div>
 
    </body>